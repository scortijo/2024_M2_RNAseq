---
layout: post
title: "Normalisation et vérification des données"
author: "Sandra"
date: "2024-08-05"
output: rmdformats::downcute
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Présentation des données de RNAseq


Vous allez travailler sur des données non publiées (elles sont sur moodle et non disponibles sur ce site du cours), merci de ne pas les partager et les déposer en ligne.  

Il s'agit de RNAseq qui ont été effectués pour un sauvage Col-0 et le mutant *arp6-1* qui ont poussé avec soit une faible (0.5mM) soit une forte (10mM) concentration en azote. Ily a donc au total:  
- 3 réplicats du sauvage Col-0 avec une faible (0.5mM) concentration en azote  
- 3 réplicats du sauvage Col-0 avec une forte (10mM) concentration en azote   
- 3 réplicats du sauvage mutant *arp6-1* avec une faible (0.5mM) concentration en azote  
- 3 réplicats du sauvage mutant *arp6-1* avec une forte (10mM) concentration en azote  

La protéine ARP6 est impliquée dans l'intégration du variant d'histone H2A.Z dans la chromatine. Le mutant *arp6-1* comporte donc une faible quantité de H2A.Z dans la chromatine, remplacé par l'histone H2A.   

<br>

**L'objectif de ce projet est d'étudier le rôle possible de H2A.Z dans la réponse transcriptionnelle à la quantité d'azote dans le milieu de culture des plantes**

<br>

<span style="color:green">Une grosse partie du code est indiquée pour les premières étapes, mais plus le projet avance plus vous aurez à trouver le code par vous-même à l'aide des indications dans le matériel et de ce que vous trouvez dans les aides R et en ligne</span>

# Préparation de l'environnement et chargement des données

- Tout d'abord téléchargez le support du cours et les données.  

- Ensuite ouvrez Rstudio et créez un nouveau document R Markdown (ou script R) que vous enregistrez dans votre dossier de travail (là où sont vos données et où vous voulez enregistrer les figures).  

- Chargez les librairies dont vous aurez besoin en utilisant la fonction suivante (exemple pour une librarie).
```{r}
library(tidyverse)
```
Voici la liste des librairies à charger:  
- tidyverse  
- visdat  


```{r, echo=FALSE}
# toutes les libraries dont nous avons besoin pour cette partie du cours
library(visdat)
```

- Enfin, chargez les données et mettez les dans un objet à l'aide du code suivant (modifiez en fonction du chemin vers votre fichier):
```{r, message=FALSE}
RNAseq_data <- read_tsv("../../../Raw_featureCounts_WT_arp6.txt")

RNAseq_data
```

Vous avez une ligne par gène et une colonne par échantillon.


# Vérification de l'import des données

Avant de faire la normalisation des données et leur vérification, nous devons nous assurer que l'import c'est bien passé.

> Pour cela, vérifiez que nous avons bien le nombre de lignes et colonnes attendu, 
que les colonnes sont bien au bon format et qu'il n'y a pas de données manquantes.  

> Exemple de fonctions que vous pouvez utiliser: `dim()`, `vis_dat`

```{r, echo=FALSE}

vis_dat(RNAseq_data)


```
Nous voyons ici que le format des données est attendu:  
- Il n'y a pas de données manquantes.  
- La colonne avec le nom des gène est bien du texte.  
- Les colonnes avec les valeurs d'expression sont bien numériques.  


# Normalisation par la taille de la librarie

# ACP pour s'assurer que les réplicats sont suffisamment similaires

# Etude de l'expression se quelques gènes pour lesquels nous avons des résultats préliminaires 







